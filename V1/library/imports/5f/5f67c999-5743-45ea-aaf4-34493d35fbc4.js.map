{"version":3,"sources":["assets\\scripts\\Home\\script\\Email.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport axios from '../../utils/axiosUtils';\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nvar Item = cc.Class({\r\n    name: 'EmailItem',\r\n    properties: {\r\n        id: 0,\r\n        itemName: '',\r\n        itemPrice: 0,\r\n        iconSF: cc.SpriteFrame\r\n    },\r\n});\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    maskBox: cc.Node = null;\r\n\r\n    /**\r\n     * 主盒子\r\n     */\r\n    @property(cc.Node)\r\n    mainBox: cc.Node = null;\r\n\r\n    /**\r\n     * Item Prefab 资源\r\n     */\r\n    @property(cc.Prefab)\r\n    listPrefab: cc.Prefab = null;\r\n\r\n    /**\r\n     * 左上角盒子\r\n     */\r\n    @property(cc.Node)\r\n    leftTopContent: cc.Node = null;\r\n\r\n    /**\r\n     * 主盒子内容\r\n     */\r\n    @property(cc.Label)\r\n    mainContent: cc.Label = null;\r\n\r\n    /**\r\n     * 左侧盒子\r\n     */\r\n    @property(cc.Node)\r\n    leftTopBox: cc.Node = null;\r\n\r\n    /**\r\n     * 左下角盒子\r\n     */\r\n    @property(cc.Node)\r\n    leftBottomBox: cc.Node = null;\r\n\r\n    /**\r\n     * 活动数据\r\n     */\r\n    @property(Item)\r\n    emailData: typeof Item[] = [];\r\n\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    start() {\r\n        this.fetchEmailRequest();\r\n    }\r\n    \r\n    /**\r\n     * 邮件界面显示\r\n     */\r\n    emailPopupShow() {\r\n        this.fetchEmailRequest();\r\n        const { leftTopBox, leftBottomBox, maskBox } = this;\r\n        maskBox.scale = 1;\r\n        leftTopBox.runAction(\r\n            cc.moveBy(.5, cc.v2(-leftTopBox.width, 0)).easing(cc.easeCubicActionOut()),\r\n        );\r\n        // 底部窗口弹出\r\n        setTimeout(() => {\r\n            leftBottomBox.scale = 1;\r\n            // leftBottomBox.runAction(\r\n            //     cc.moveBy(0.5, cc.v2(0, -leftBottomBox.height), 0).easing(cc.easeCubicActionOut()),\r\n            // );\r\n        }, 700);\r\n    }\r\n\r\n    \r\n    /**\r\n     * 邮件界面隐藏\r\n     */\r\n    emailPopupHide() {\r\n        this.node.destroy();\r\n        // const { leftTopBox, leftBottomBox, maskBox } = this;\r\n        // maskBox.scale = 0;\r\n        // leftBottomBox.scale = 0;\r\n        // leftTopBox.runAction(\r\n        //     cc.moveBy(0, cc.v2(leftTopBox.width, 0)).easing(cc.easeCubicActionOut()),\r\n        // );\r\n        // leftBottomBox.runAction(\r\n        //     cc.moveBy(0, cc.v2(0, leftBottomBox.height)).easing(cc.easeCubicActionOut()),\r\n        // );\r\n    }\r\n\r\n\r\n    /**\r\n     * 获取邮件消息\r\n     */\r\n    fetchEmailRequest() {\r\n        axios.api('home_email').then((data) => {\r\n            this.emailData = data;\r\n            data.forEach((item: any, index: number) => {\r\n                const newItem = cc.instantiate(this.listPrefab);\r\n                this.leftTopContent.addChild(newItem);\r\n                const newComponent = newItem.getComponent('emailActivityListItem');\r\n                if (item.template) {\r\n                    item = {\r\n                        ...item,\r\n                        ...item.template,\r\n                    }\r\n                }\r\n                newComponent.init(item);\r\n                newComponent.clickEvent = () => new Promise((resolve, reject) => {\r\n                    if (!item.is_receive) {\r\n                        axios.api('email_content', {\r\n                            params: {\r\n                                emailId: item.id,\r\n                            },\r\n                        }).then((res) => {\r\n                            item.content = res.content;\r\n                            resolve();\r\n                        });\r\n                    }\r\n                });\r\n                newComponent.ParentClass = this;\r\n                newItem.y = (newItem.y - index * 40) - 200;\r\n                this.leftTopContent.height += 40;\r\n                if (index === 0) {\r\n                    newComponent.onClick();\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\n"]}