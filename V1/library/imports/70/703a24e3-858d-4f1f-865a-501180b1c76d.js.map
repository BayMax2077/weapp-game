{"version":3,"sources":["assets\\scripts\\lib\\tool.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import State from \"../../scripts/utils/state\";\r\n// import axios from '../utils/axiosUtils';\r\n\r\n/**\r\n * 工具类\r\n */\r\nexport const url = State.OSS_BASE;\r\n\r\n/**\r\n *  格式化日期\r\n *  @param fmt 日期格式 如：yyyy-MM-dd HH:mm:ss\r\n *  @param form 指定时间 不传参 默认目前时间\r\n */\r\nexport function dateFrom(fmt: string = 'yyyy-MM-dd HH:mm:ss', form?: number) {\r\n    const date: any = form ? new Date(form) : new Date();\r\n    const o: any = {\r\n        'M+': date.getMonth() + 1,\r\n        'd+': date.getDate(),\r\n        'h+': date.getHours() % 12 === 0 ? 12 : date.getHours() % 12,\r\n        'H+': date.getHours(),\r\n        'm+': date.getMinutes(),\r\n        's+': date.getSeconds(),\r\n        'q+': Math.floor((date.getMonth() + 3) / 3),\r\n        'S': date.getMilliseconds(),\r\n    };\r\n    const week: string[] = [ '日', '一', '二', '三', '四', '五', '六' ];\r\n    const season: string[] = [ '', '春', '夏', '秋', '冬' ];\r\n    if (/(y+)/.test(fmt)) {\r\n        fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length));\r\n    }\r\n    if (/(E+)/.test(fmt)) {\r\n        fmt = fmt.replace(RegExp.$1, ((RegExp.$1.length > 1) ? (RegExp.$1.length > 2 ? '星期' : '周') : '')\r\n        + week[date.getDay()]);\r\n    }\r\n    if (/(q+)/.test(fmt)) {\r\n        fmt = fmt.replace(RegExp.$1, season[o['q+']] + ((RegExp.$1.length > 1) ? '季' : ''));\r\n    }\r\n    let k: string;\r\n    for (k in o) {\r\n        if (new RegExp('(' + k + ')').test(fmt)) {\r\n            fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length)));\r\n        }\r\n    }\r\n    return fmt;\r\n}\r\n\r\n\r\n/**\r\n * 加载图片\r\n * @param url       - 图片url\r\n * @param callback  - 回调函数\r\n * @param type      - 图片类型\r\n * @param urlParams - 携带参数\r\n * @param imgType   - 图片后缀\r\n */\r\nconst urlBase = {\r\n    avatar: State.OSS_BASE + '/avatar/',\r\n};\r\nexport function loadImg(url, callback, type?: 'avatar', urlParams?: any, imgType: 'png' | false = 'png') {\r\n\r\n    if (type === 'avatar' && !/\\/\\//.test(url)) {\r\n        url = ![ -1, '0' ].indexOf(url) ? (urlParams || 'default') : 'default';\r\n    }\r\n\r\n    if (!/\\/\\//.test(url)) {\r\n        type && (url = urlBase[type] + url);\r\n        if (imgType) url += `.${imgType}`;\r\n    }\r\n    // console.log(url);\r\n    cc.loader.load(url, (_error, texture) => {\r\n        _error && console.error(_error);\r\n        callback(new cc.SpriteFrame(texture));\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * 分享转发\r\n * @param title    转发标题，不传则默认使用当前小游戏的昵称\r\n * @param imageUrl 转发显示图片的链接，可以是网络图片路径或本地图片文件路径或相对代码包根目录的图片文件路径。显示图片长宽比是 5:4\r\n * @param query    查询字符串，从这条转发消息进入后，可通过 wx.getLaunchOptionsSync() 或 wx.onShow() 获取启动参数中的 query。必须是 key1=val1&key2=val2 的格式。\r\n */\r\nexport const shareAppMessage = (title: string, imageUrl?: string, query?: string | object) => {\r\n    if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n        wx.shareAppMessage({\r\n            title,\r\n            imageUrl,\r\n            query,\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 上传文件\r\n * @param unit 文件单位\r\n */\r\nexport const uploadFile = (ossOption, fileName, unit?: string) => {\r\n    return new Promise((reslove, reject) => {\r\n        console.log(ossOption);\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            // 微信上传\r\n            wx.chooseImage({\r\n                success (res) {\r\n                    const tempFilePaths = res.tempFilePaths\r\n                    console.log(tempFilePaths);\r\n                    const suffix = tempFilePaths[0].match(/\\.\\w+$/);\r\n                    ossOption.key = ossOption.startsWith + fileName + suffix;\r\n\r\n                    if (!/^\\.(png|jpg)/.test(suffix)) {\r\n                        return reject('文件类型错误!');\r\n                    }\r\n\r\n                    if (res.tempFiles[0].size > 1024 * 500) {\r\n                        return reject('文件不能大于500KB!');\r\n                    }\r\n\r\n                    Window.wx.uploadFile({\r\n                        url: ossOption.host,\r\n                        filePath: tempFilePaths[0],\r\n                        name: 'file',\r\n                        formData: ossOption,\r\n                        header: {\r\n                            'content-type': 'application/json',\r\n                        },\r\n                        success_action_status: '200',\r\n                        success: reslove,\r\n                        fial: reject,\r\n                    });\r\n                },\r\n                fial: reject,\r\n            });\r\n        } else if (CC_PREVIEW) {\r\n            const fileInput = document.createElement('input');\r\n            fileInput.type = 'file';\r\n            fileInput.click();\r\n            const formData = new FormData();\r\n            Object.keys(ossOption).forEach(key => {\r\n                formData.append(key, ossOption[key]);\r\n            });\r\n\r\n            fileInput.onchange = (e) => {\r\n                // reslove(fileInput.files);\r\n                formData.append('file', fileInput.files[0]);\r\n                console.log(fileInput.files);\r\n                // axios.request('post', ossOption.host, {\r\n                //     data: formData,\r\n                // }).then(res => {\r\n                //     console.log(res);\r\n                // })\r\n                \r\n                let xhr = cc.loader.getXMLHttpRequest();\r\n                xhr.open('post', ossOption.host, true);\r\n                // xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;');\r\n                xhr.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded;charset=UTF-8\"); \r\n                xhr.onreadystatechange = function () {\r\n                    \r\n                };\r\n                let dataStr = '';\r\n                Object.keys(formData || {}).forEach(key => {\r\n                    dataStr += key + '=' + encodeURIComponent(formData[key]) + '&';\r\n                })\r\n                console.log(dataStr);\r\n                xhr.send(formData);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * 设置资源是否被释放\r\n * @param Recursively UID\r\n * @param Auto        是否自动释放\r\n */\r\nexport const setAutoRecursively = (Recursively: string[], Auto: boolean = true) => {\r\n    Recursively.forEach(val => cc.loader.setAutoReleaseRecursively(val, Auto));\r\n}\r\n\r\n\r\n/**\r\n * 获取启动时的参数\r\n */\r\nexport const luanchOptions = (() => {\r\n    let shareOption = {\r\n      title: '玩休闲游戏，赢优惠券，一起来玩~~',\r\n      imageUrl: State.OSS_BASE + '/H5Game/share/main.png',\r\n    };\r\n    let options;\r\n    if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n        options = wx.getLaunchOptionsSync().query;\r\n        wx.showShareMenu({\r\n            withShareTicket: true,\r\n        });\r\n        wx.onShareAppMessage(() => shareOption);\r\n    }\r\n    return {\r\n        /**\r\n         * 分享参数\r\n         */\r\n        query: options || {},\r\n        /**\r\n         * 设置分享参数\r\n         */\r\n        setShareOption: (option: typeof shareOption) => shareOption = option,\r\n    };\r\n})();\r\n\r\n\r\n/**\r\n * 如果为刘海屏则进行适配\r\n * @param node 节点\r\n */\r\nexport const screenFringe = (nodes: cc.Node[]) => {\r\n    const isFringe = hasScreenFringe();\r\n    if (isFringe) {\r\n        nodes.forEach(node => {\r\n            node.getComponent(cc.Widget).left += 60;\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 监听小游戏回到前台的事件\r\n * @param callback 回调\r\n * @param that     this指向\r\n */\r\nexport const onShow = (callback, that = null) => {\r\n    if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n        wx.onShow(callback.bind(that));\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * 监听小游戏回到前台的事件\r\n * @param callback 回调\r\n * @param that     this指向\r\n */\r\nexport const offShow = (callback, that = null) => {\r\n    if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n        wx.offShow(callback.bind(that));\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * 监听小游戏回到前台的事件\r\n * @param callback 回调\r\n * @param that     this指向\r\n */\r\nexport const onHide = (callback, that = null) => {\r\n    if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n        wx.onHide(callback.bind(that));\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * 监听小游戏回到前台的事件\r\n * @param callback 回调\r\n * @param that     this指向\r\n */\r\nexport const offHide = (callback, that = null) => {\r\n    if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n        wx.offHide(callback.bind(that));\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * 判断是否为刘海\r\n */\r\nconst fringeScreenModels = [\r\n  'iPhone X', 'iPhone x', 'vivo X21A', 'ASUS Zenfone 5',\r\n  'Ulefone T2 Pro', 'Leagoo S9', 'HUAWEI P20', 'DooGee V',\r\n  'OPPO R15', 'LG G7', 'SAMSUNG S9', 'COR-AL00',\r\n  'vivo Y83A', 'LLD-AL20', 'vivo Z1', 'PACM00', 'PAAM00'\r\n];\r\nexport const hasScreenFringe = () => {\r\n  const systemInfo = cc.sys.platform === cc.sys.WECHAT_GAME ? wx.getSystemInfoSync() : { model: null };\r\n\r\n  if (systemInfo.model != null) {\r\n      for (let i in fringeScreenModels) {\r\n          if (systemInfo.model.indexOf(fringeScreenModels[i]) > -1) {\r\n              // 是已知机型里的刘海手机\r\n              return true;\r\n          }\r\n      }\r\n  }\r\n  // 屏幕宽高比大于2，基本上90%的手机可以确定是刘海屏，就算个别手机不是也按刘海屏处理\r\n  // 竖屏游戏判断：\r\n  // if (systemInfo.windowHeight >= 800 || systemInfo.windowHeight / systemInfo.windowWidth > 2) {\r\n  //     return true;\r\n  // }\r\n\r\n  // 横屏游戏判断：\r\n  // if (this.systemInfo.windowWidth >= 800 || this.systemInfo.windowWidth / this.systemInfo.windowHeight > 2) {\r\n  //     return true;\r\n  // }\r\n  return false;\r\n}\r\n\r\n\r\n/**\r\n * 检测旋转屏幕\r\n */\r\nexport const testingRotate = () => {\r\n    const { width, height } = cc.view.getFrameSize();\r\n    cc.view.setFrameSize(width, width < height ? height / 3 : height);\r\n    if (width < height) {\r\n      alert('请横屏游玩!');\r\n    }\r\n}"]}