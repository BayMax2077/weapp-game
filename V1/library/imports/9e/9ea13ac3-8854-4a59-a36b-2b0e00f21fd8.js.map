{"version":3,"sources":["assets\\scripts\\Home\\script\\Portrait.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,kFAAkF;AAClF,yFAAyF;AACzF,mBAAmB;AACnB,4FAA4F;AAC5F,mGAAmG;AACnG,8BAA8B;AAC9B,4FAA4F;AAC5F,mGAAmG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE7F,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAC1C,2CAAsC;AACtC,qDAA2C;AAC3C,kDAAoD;AAIpD;IAAsC,4BAAY;IAAlD;QAAA,qEAmEC;QAjEG;;WAEG;QAEH,QAAE,GAAa,IAAI,CAAC;QAEpB;;WAEG;QAEH,cAAQ,GAAa,IAAI,CAAC;QAE1B;;WAEG;QAEH,YAAM,GAAc,IAAI,CAAC;QAEzB;;WAEG;QAEH,aAAO,GAAa,IAAI,CAAC;QAEzB;;WAEG;QAEH,UAAI,GAAa,IAAI,CAAC;;IAqC1B,CAAC;IAlCG,wBAAK,GAAL;QACI,IAAI,CAAC,cAAc,CAAC,eAAK,CAAC,QAAQ,CAAC,CAAC;QACpC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACjE,CAAC;IAGD,4BAAS,GAAT;QACG,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,gBAAgB,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACjE,CAAC;IAGD;;;OAGG;IACG,iCAAc,GAApB,UAAqB,QAAkC;;;;;;;6BAC/C,CAAC,QAAQ,EAAT,wBAAS;wBACQ,qBAAM,oBAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,IAAI,EAAE,EAAA;;wBAA/C,GAAG,GAAQ,SAAoC;wBACrD,QAAQ,yBAAQ,eAAK,CAAC,QAAQ,GAAK,GAAG,CAAE,CAAC;;;wBAGrC,QAAQ,GAAmC,QAAQ,SAA3C,EAAE,EAAE,GAA+B,QAAQ,GAAvC,EAAE,OAAO,GAAsB,QAAQ,QAA9B,EAAE,IAAI,GAAgB,QAAQ,KAAxB,EAAE,SAAS,GAAK,QAAQ,UAAb,CAAc;wBAC5D,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC;wBAChC,IAAI,CAAC,EAAE,CAAC,MAAM,GAAG,MAAM,GAAG,CAAC,EAAE,IAAI,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;wBACtD,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,QAAQ,EAAE,CAAC;wBACzC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;wBACnC,SAAS;wBACT,wCAAwC;wBACxC,cAAO,CAAC,SAAS,EAAE,UAAA,WAAW;4BAC1B,IAAI,WAAW,IAAI,KAAI,CAAC,MAAM,EAAE;gCAC5B,KAAI,CAAC,MAAM,CAAC,WAAW,GAAG,WAAW,CAAC;6BACzC;wBACL,CAAC,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;;;;;KACpB;IA5DD;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wCACC;IAMpB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;8CACO;IAM1B;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;4CACK;IAMzB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6CACM;IAMzB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;0CACG;IA9BL,QAAQ;QAD5B,OAAO;OACa,QAAQ,CAmE5B;IAAD,eAAC;CAnED,AAmEC,CAnEqC,EAAE,CAAC,SAAS,GAmEjD;kBAnEoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\nimport State from '../../utils/state';\r\nimport axios from '../../utils/axiosUtils';\r\nimport { loadImg } from '../../../scripts/lib/tool';\r\nimport { Utils } from '../../interface/index';\r\n\r\n@ccclass\r\nexport default class Portrait extends cc.Component {\r\n\r\n    /**\r\n     * 账号id\r\n     */\r\n    @property(cc.Label)\r\n    id: cc.Label = null;\r\n\r\n    /**\r\n     * 昵称\r\n     */\r\n    @property(cc.Label)\r\n    nickName: cc.Label = null;\r\n\r\n    /**\r\n     * 头像\r\n     */\r\n    @property(cc.Sprite)\r\n    avatar: cc.Sprite = null;\r\n\r\n    /**\r\n     * 钻石\r\n     */\r\n    @property(cc.Label)\r\n    diamond: cc.Label = null;\r\n\r\n    /**\r\n     * 金币\r\n     */\r\n    @property(cc.Label)\r\n    gold: cc.Label = null;\r\n\r\n\r\n    start () {\r\n        this.updateUserData(State.userInfo);\r\n        cc.game.on('updateUserData', this.updateUserData.bind(this));\r\n    }\r\n\r\n\r\n    onDestroy() {\r\n       cc.game.off('updateUserData', this.updateUserData.bind(this));\r\n    }\r\n\r\n\r\n    /**\r\n     * 用户数据更新时\r\n     * @param userData 用户信息, 如果不传入则会自动去服务器更新\r\n     */\r\n    async updateUserData(userData?: Utils.State['userInfo']) {\r\n        if (!userData) {\r\n            const res: any = await axios.api('get_assets').then();\r\n            userData = { ...State.userInfo, ...res };\r\n        }\r\n\r\n        const { nickname, id, diamond, gold, avatarUrl } = userData;\r\n        this.nickName.string = nickname;\r\n        this.id.string = 'ID: ' + (id || '000000').toString();\r\n        this.diamond.string = diamond.toString();\r\n        this.gold.string = gold.toString();\r\n        // 头像在线加载\r\n        // avatarUrl === 1 时加载ID的头像否则加载Default头像\r\n        loadImg(avatarUrl, spriteFrame => {\r\n            if (spriteFrame && this.avatar) {\r\n                this.avatar.spriteFrame = spriteFrame;\r\n            }\r\n        }, 'avatar', id);\r\n    }\r\n}\r\n"]}