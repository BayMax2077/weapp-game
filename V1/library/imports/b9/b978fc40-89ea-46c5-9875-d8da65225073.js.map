{"version":3,"sources":["assets\\scripts\\Home\\Home.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { setAutoRecursively } from '../lib/tool';\r\nimport { screenFringe } from '../lib/tool';\r\nimport State from '../utils/state';\r\nimport axios from '../utils/axiosUtils';\r\nimport socket from '../lib/socketIO';\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n// socket初始化\r\nsocket.init();\r\n// 是否为第一次打开\r\nlet onlyOpen = false;\r\n\r\n@ccclass\r\nexport default class Home extends cc.Component {\r\n    // 活动资源\r\n    @property(cc.Prefab) ActivityPrefab: cc.Prefab = null;\r\n    // 邮件资源\r\n    @property(cc.Prefab) EmailPrefab: cc.Prefab = null;\r\n    // 商城资源\r\n    @property(cc.Prefab) ShopPrefab: cc.Prefab = null;\r\n    // 用户中心\r\n    @property(cc.Prefab) UserCenter: cc.Prefab = null;\r\n    // 背景一\r\n    @property(cc.Sprite) bg: cc.Sprite = null;\r\n    // 背景二\r\n    @property(cc.Sprite) bg2: cc.Sprite = null;\r\n    // 背景一 图标\r\n    @property(cc.Node) bgIcon: cc.Node = null;\r\n    // 背景二 图标\r\n    @property(cc.Node) bg2Icon: cc.Node = null;\r\n    // 右上角节点\r\n    @property(cc.Node) rightTopBar: cc.Node = null;\r\n    // 左侧栏目\r\n    @property(cc.Node) leftBox: cc.Node = null;\r\n    // 背景状态\r\n    bgStatus = true;\r\n\r\n    onLoad () {\r\n        // 登录检测\r\n        const userInfo = localStorage.getItem('userInfo');\r\n        if (!userInfo) {\r\n            cc.director.loadScene('loginPage');\r\n            return !1;\r\n        }\r\n        axios.api('room_exit').then(() => {});\r\n\r\n        // 如果非微信小游戏则不进行填充\r\n        if (!cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n            this.rightTopBar.getComponent(cc.Widget).right = 0;\r\n        }\r\n    }\r\n\r\n\r\n    start() {\r\n        // 默认打开的内容\r\n        if (!onlyOpen) {\r\n            this.openPopup(false, 'ActivityPrefab', () => {\r\n                setTimeout(() => {\r\n                    // 回来提示\r\n                    State.tips(`欢迎回来, ${State.userInfo.nickname}!`, 5, true);\r\n                }, 700);\r\n            });\r\n            onlyOpen = true;\r\n        }\r\n        // 刘海兼容适配\r\n        screenFringe([ this.leftBox ]);\r\n\r\n        // BGM音量\r\n        this.node.getComponent(cc.AudioSource).volume = State.system.config.volume.music;\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开游戏\r\n     * @param _event   - 事件体\r\n     * @param gameName - 游戏名\r\n     */\r\n    openGame(_event, gameName: string) {\r\n        cc.loader.loadRes('prefab/groupLoading', (_err, prefab) => {\r\n            const instantiate = cc.instantiate(prefab);\r\n            cc.director.getScene().addChild(instantiate);\r\n            cc.director.preloadScene(gameName, (_err) => {\r\n                instantiate.getComponent('GroupLoading').close();\r\n                cc.director.loadScene(gameName);\r\n            });\r\n            // cc.director.loadScene(gameName);\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开弹窗\r\n     * @param _event    - 事件体\r\n     * @param popupName - 弹窗名\r\n     */\r\n    openPopup(_event, popupName: string, closeCallBack?: any) {\r\n        const instantiate = cc.instantiate(this[popupName]);\r\n        const script = instantiate.getComponent(popupName.replace('Prefab', ''));\r\n        if (closeCallBack && script) script.closeCallBack = closeCallBack;\r\n        cc.director.getScene().addChild(instantiate);\r\n    }\r\n\r\n\r\n    /**\r\n     * 背景切换\r\n     */\r\n    backageSwitch() {\r\n        this.bgStatus = !this.bgStatus;\r\n        const bgStatus = this.bgStatus;\r\n        this.bg.node.runAction(\r\n            !bgStatus ? cc.fadeOut(1) : cc.fadeIn(1),\r\n        );\r\n        this.bg2.node.runAction(\r\n            bgStatus ? cc.fadeOut(1) : cc.fadeIn(1),\r\n        );\r\n        this.bgIcon.scale = bgStatus ? 1 : 0;\r\n        this.bg2Icon.scale = bgStatus ? 0 : 1;\r\n    }\r\n\r\n\r\n    /**\r\n     * 打开商城\r\n     * @param _e        - 事件\r\n     * @param shopIndex - 商城菜单\r\n     */\r\n    openShop(_e, shopIndex: string) {\r\n        const instantiate = cc.instantiate(this.ShopPrefab);\r\n        instantiate.getComponent('Shop').defaultTarget = shopIndex;\r\n        cc.director.getScene().addChild(instantiate);\r\n    }\r\n\r\n    \r\n    onDestroy() {\r\n        setAutoRecursively([\r\n            '68b61513-780a-4964-9622-adbea2867cda',\r\n            '0b7da469-5226-4405-aad7-56210d04d191'\r\n        ]);\r\n    }\r\n}\r\n"]}