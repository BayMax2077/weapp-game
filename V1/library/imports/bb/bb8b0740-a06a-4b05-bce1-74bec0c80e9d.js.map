{"version":3,"sources":["assets\\scripts\\Games\\flightChess\\flightChess.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\nimport { startPoint, chessPoint, notePoint, centerPedestal } from './flightGameData';\r\nimport { FlightPlayersData } from '../../interface/game/flightChessInterface';\r\nimport axios from '../../utils/axiosUtils';\r\nimport State from '../../utils/state';\r\nimport { UserData } from '../../interface/game/fourCard';\r\nimport { loadImg, setAutoRecursively } from '../../../scripts/lib/tool';\r\n\r\nconst FlightPlayer = cc.Class({\r\n    name: 'FlightPlayer',\r\n    properties: {\r\n        id: -1,\r\n        box: cc.Node,\r\n        nickName: cc.Label,\r\n        pedestal: [ cc.Sprite ],\r\n        avatarUrl: null,\r\n    },\r\n});\r\n\r\n// 临时测试用例\r\nlet index = 0;\r\n// 聚焦计时器\r\nlet pedestalFouse = null;\r\n\r\n@ccclass\r\nexport default class FlightChess extends cc.Component {\r\n    // 玩家坐标数据\r\n    @property(FlightPlayer) FlightPlayer: FlightPlayersData[] = [];\r\n    // 加一掷骰子的机会\r\n    @property(cc.Node) addDiceCount: cc.Node = null;\r\n    // 游戏开始字样\r\n    @property(cc.Node) gameStartNode: cc.Node = null;\r\n    // 完成状态的图片\r\n    @property(cc.SpriteFrame) complete: cc.SpriteFrame = null;\r\n    // // 爆炸动画\r\n    // @property(cc.Node) exploade: cc.Node = null;\r\n    // 箭头节点\r\n    @property(cc.Node) arraw: cc.Node = null;\r\n    // 骰子\r\n    @property(cc.Node) dice: cc.Node = null;\r\n    // 房间号\r\n    @property(cc.Label) roomCode: cc.Label = null;\r\n    // 玩家数据\r\n    playersData: UserData[] = [];\r\n    // 弹窗资源\r\n    @property(cc.Prefab) popupPrefab: cc.Prefab = null;\r\n    // 结算界面资源\r\n    @property(cc.Prefab) chessPrefab: cc.Prefab = null;\r\n    // 玩家数据\r\n    roomInfo = {\r\n        gameData: {\r\n            chess: [],\r\n        },\r\n        players: [],\r\n        roomCode: '',\r\n        playerIndex: 1,\r\n    };\r\n    // 棋子出生点\r\n    chessSpawn: number[][][] = [];\r\n    // 允许起飞点数\r\n    takeOff = [];\r\n    // 行走点数       \r\n    setpNumber = -1;\r\n    // 骰子状态\r\n    diceState: boolean = false;\r\n    // 中间步数下标\r\n    centerChessIndex: number[][] = [[], [], [], []];\r\n\r\n    bindonGameData = (data) => this.onGameData(data);\r\n    bindfetchRoomInfo = () => this.fetchRoomInfo();\r\n    bindrommleave = (data) => this.rommleave(data);\r\n\r\n    onLoad() {\r\n        setAutoRecursively([\r\n            'fc30fbe0-1668-4af2-8dcb-a798b469719b',\r\n        ]);\r\n        // console.log(this.FlightPlayer);\r\n        // console.log('load');\r\n        const that = this;\r\n        State.io.on('flightChess/gameData', that.bindonGameData);\r\n        State.io.on('rommjoin', that.bindfetchRoomInfo);\r\n        State.io.on('rommleave', that.bindrommleave);\r\n        this.dice.getComponent('dice').onClickEvent = this.diceOut.bind(this);\r\n        this.dice.getComponent(cc.Button).enabled = false;\r\n        this.fetchRoomInfo();\r\n\r\n        this.dice.getComponent('dice').event = () => {\r\n            // const state = this.diceState;\r\n            // if (state) {\r\n            //     this.diceState = false;\r\n            // }\r\n            // return state;\r\n            return true;\r\n        };\r\n        // 模拟测试\r\n        // this.gameStart(this.roomInfo);\r\n    }\r\n\r\n\r\n    /**\r\n     * 接收到游戏数据时\r\n     * @param data - IO数据\r\n     */\r\n    onGameData(data: any) {\r\n        data = typeof data === 'string' ? JSON.parse(data) : data;\r\n        console.log(data);\r\n        data.callback && data.msg && this[data.callback](data.msg);\r\n    }\r\n\r\n\r\n    /**\r\n     * 当玩家加入房间时\r\n     */\r\n    fetchRoomInfo() {\r\n        axios.api('room_info').then(res => {\r\n            res.players.forEach((player, index) => {\r\n                console.log(this.FlightPlayer);\r\n                const target = this.FlightPlayer[index];\r\n                target.nickName.string = player.nickname;\r\n                loadImg(\r\n                    player.avatarUrl,\r\n                    spriteFrame => {\r\n                        target.avatarUrl = spriteFrame;\r\n                    },\r\n                    'avatar',\r\n                    player.id\r\n                );\r\n            });\r\n            this.roomCode.string = '房间号: ' + res.roomCode;\r\n            this.roomInfo = res;\r\n            if (res.isStart) this.gameStart(res);\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 被销毁时\r\n     */\r\n    onDestroy() {\r\n        clearInterval(pedestalFouse);\r\n        State.io.off('flightChess/gameData', this.bindonGameData);\r\n        State.io.off('rommjoin', this.bindfetchRoomInfo);\r\n        State.io.off('rommleave', this.bindrommleave);\r\n    }\r\n\r\n\r\n    /**\r\n     * 玩家进行下一步操作时\r\n     * @param ioData 数据\r\n     */\r\n    setp(ioData: {\r\n        dice: number;\r\n        index: number;\r\n        flyIndex: number; // 棋子下标 如果当前棋子下标为-1则为出棋，否则为行走步数\r\n    }, isPlayer: boolean = false) {\r\n        const romm = this.roomInfo;\r\n        // 获取目标棋子\r\n        ioData.dice++;\r\n\r\n        // 为自己的回合\r\n        // console.log(romm.playerIndex, ioData.index , isPlayer);\r\n        if (romm.playerIndex === ioData.index && isPlayer) {\r\n            // 如果还有未起飞的棋子 且当前骰子点数为起飞点\r\n            this.setpNumber = ioData.dice;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 点击飞机事件\r\n     */\r\n    chessTakeOff(_e, chessIndex: number, playerIndex?: number, setpNumber?: number) {\r\n        const { roomInfo, takeOff } = this;\r\n        const { gameData } = roomInfo;\r\n        playerIndex = playerIndex !== undefined ? playerIndex : roomInfo.playerIndex;\r\n        setpNumber = setpNumber || this.setpNumber;\r\n        // console.log('chessTakeOff.click ===============>', chessIndex);\r\n\r\n        // 隐藏聚焦圈\r\n        if (_e) this.clearFouseState();\r\n        // console.log(_e);\r\n\r\n        // console.log(setpNumber);\r\n        if (setpNumber !== -1) {\r\n            const targetChess = gameData.chess[playerIndex][chessIndex];\r\n            const targetSprite = this.FlightPlayer[playerIndex].pedestal[chessIndex];\r\n            // 检测是否允许玩家出棋\r\n            if (targetChess === -2 && takeOff.indexOf(setpNumber) !== -1) {\r\n                // console.log(gameData.chess[playerIndex], gameData);\r\n                const tStartPoint = startPoint[playerIndex];\r\n                this.moveChess(targetSprite, tStartPoint);\r\n                gameData.chess[playerIndex][chessIndex] = -1;\r\n                // console.log('出棋',chessIndex, targetChess === -2, takeOff.indexOf(setpNumber) !== -1);\r\n                // console.log(gameData.chess[playerIndex], gameData);\r\n            } else if (targetChess > -2) {\r\n                const outIndex =  notePoint[playerIndex].out - 1;\r\n                const nextIndex = (targetChess === -1 ? outIndex : targetChess) + setpNumber;\r\n                if (targetChess === -1) {\r\n                    gameData.chess[playerIndex][chessIndex] = outIndex;\r\n                }\r\n                this.moveChess(targetSprite, false, .5, {\r\n                    to: nextIndex,\r\n                    from: gameData.chess[playerIndex],\r\n                    index: chessIndex,\r\n                }, playerIndex);\r\n                // gameData.chess[playerIndex][chessIndex] = nextIndex;\r\n            } else {\r\n                // console.log('skip');\r\n                return false;\r\n            }\r\n            if (playerIndex === roomInfo.playerIndex) {\r\n                // 通讯下一步\r\n                State.io.emit('flightChess/setp', {\r\n                    to: setpNumber,\r\n                    chessIndex,\r\n                    index: playerIndex,\r\n                });\r\n                this.setpNumber = -1;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 允许玩家发牌时\r\n     * @param data io数据\r\n     */\r\n    userSendChess(data: any) {\r\n        const { next } = data;\r\n        const { playerIndex } = this.roomInfo;\r\n        // console.log(data);\r\n        if (next) {\r\n            index = next.index;\r\n            // 如果为当前玩家回合\r\n            this.dice.getComponent(cc.Button).enabled = index === playerIndex;\r\n            // 其他玩家数据更新\r\n            if (next.prveChess && next.prveChess.index !== playerIndex) {\r\n                const { prveChess } = next;\r\n                if (prveChess) {\r\n                    this.dice.getComponent('dice').onClick(prveChess.to - 1);\r\n                    this.chessTakeOff(false, prveChess.chessIndex, prveChess.index, prveChess.to);\r\n                }\r\n            }\r\n        }\r\n        const nextPlayer = this.FlightPlayer[index];\r\n        const { x, y } = nextPlayer.box;\r\n        // 移动骰子\r\n        this.dice.runAction(\r\n            cc.moveTo(1, x + 45, y - 5).easing(cc.easeBackIn()),\r\n        );\r\n        // 移动箭头\r\n        this.arraw.runAction(\r\n            cc.moveTo(1, x + 60, y + 45).easing(cc.easeBackIn()),\r\n        );\r\n        if (index === playerIndex) {\r\n            this.diceState = true;\r\n        }\r\n    }\r\n    \r\n\r\n    /**\r\n     * 玩家离开游戏时\r\n     * @param data - 数据\r\n     */\r\n    rommleave(ioData) {\r\n        ioData = JSON.parse(ioData);\r\n        if (ioData && ioData.data && ioData.data.id === this.roomInfo.players[0].id) {\r\n            this.gameOver({ type: 0 });\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 开始游戏\r\n     * @param roomInfo - 卡牌数组\r\n     */\r\n    gameStart(roomInfo: any) {\r\n        console.log(roomInfo);\r\n        this.roomCode.string = '房间号: ' + roomInfo.roomCode;\r\n        const startNode = this.gameStartNode;\r\n        this.takeOff = roomInfo.gameData.takeOff;\r\n        startNode.y = -startNode.height;\r\n        startNode.runAction(\r\n            cc.sequence(\r\n                cc.moveTo(3, 0, 0).easing(cc.easeBounceIn()),\r\n                cc.callFunc(() => startNode.active = false),\r\n            ),\r\n        );\r\n\r\n        // 初始化\r\n        this.FlightPlayer[roomInfo.playerIndex].pedestal.forEach((pedestal, index) => {\r\n            const eventHandler = new cc.Component.EventHandler();\r\n            eventHandler.target = this.node; \r\n            eventHandler.component = 'flightChess';\r\n            eventHandler.handler = 'chessTakeOff';\r\n            eventHandler.customEventData = index.toString();\r\n            const newButton = pedestal.node.addComponent(cc.Button);\r\n            newButton.clickEvents.push(eventHandler);\r\n            // console.log(index);\r\n        });\r\n\r\n        // 初始化房主信息\r\n        this.userSendChess({\r\n            next: {\r\n                index: 0,\r\n            },\r\n        });\r\n\r\n        // 隐藏聚焦圈\r\n        this.FlightPlayer.forEach((player, index) => {\r\n            player.pedestal.forEach((pedestal, o) => {\r\n                pedestal.node.children[0].active = false;\r\n                // 保存棋子重生点\r\n                if (!this.chessSpawn[index]) {\r\n                    this.chessSpawn.push([]);\r\n                }\r\n                this.chessSpawn[index].push([ pedestal.node.x, pedestal.node.y ]);\r\n                // pedestal.node.x = this.chessSpawn[index][o][0];\r\n                // pedestal.node.y = this.chessSpawn[index][o][1];\r\n            });\r\n        });\r\n        // console.log(this.chessSpawn);\r\n    }\r\n\r\n    \r\n    /**\r\n     * 退出房间\r\n     */\r\n    roomExit() {\r\n        axios.api('room_exit', {\r\n            data: {\r\n                roomCode: this.roomInfo.roomCode,\r\n            },\r\n        }).then(() => {});\r\n    }\r\n\r\n    /**\r\n     * 清除棋子聚焦状态\r\n     */\r\n    clearFouseState() {\r\n        this.FlightPlayer[this.roomInfo.playerIndex].pedestal.forEach(pedestal => pedestal.node.children[0].active = false);\r\n        clearInterval(pedestalFouse);\r\n    }\r\n\r\n\r\n    /**\r\n     * 投骰子时\r\n     * @param diceNumber 数值\r\n     */\r\n    diceOut(dice: number, event: Event | number) {\r\n        const { takeOff, roomInfo } = this;\r\n        const { playerIndex } = roomInfo;\r\n        this.diceState = false;\r\n        // 如果 非出棋的点数 且 无棋可走\r\n        if (typeof event !== 'number' && takeOff.indexOf(dice + 1) === -1 && roomInfo.gameData.chess[playerIndex].every(num => num === -2)) {\r\n            // 通讯下一步\r\n            State.io.emit('flightChess/setp', {\r\n                to: dice + 1,\r\n                chessIndex: -1,\r\n                index: playerIndex,\r\n            });\r\n            this.setpNumber = -1;\r\n            this.clearFouseState();\r\n            return;\r\n        }\r\n        \r\n        // 显示聚焦圈\r\n        this.FlightPlayer[playerIndex].pedestal.forEach((pedestal, index) => {\r\n            const targetChessIndex = this.roomInfo.gameData.chess[playerIndex][index];\r\n            if ((this.takeOff.indexOf(dice) !== -1 && targetChessIndex !== -3) || targetChessIndex > -1) {\r\n                pedestal.node.children[0].active = true\r\n            }\r\n        });\r\n        let focseState = 0;\r\n        // this.takeOff.indexOf(ioData.dice) !== -1 && targetChess.some(num => num === -2)\r\n        // 聚焦闪动\r\n        clearInterval(pedestalFouse);\r\n        pedestalFouse = setInterval(() => {\r\n            this.FlightPlayer[playerIndex].pedestal.forEach((pedestal, index) => {\r\n                const targetChessIndex = this.roomInfo.gameData.chess[playerIndex][index];\r\n                if ((this.takeOff.indexOf(dice) !== -1 && targetChessIndex !== -3) || targetChessIndex > -1) {\r\n                    pedestal.node.children[0].runAction(\r\n                        focseState ? cc.fadeOut(1) : cc.fadeIn(1),\r\n                    );\r\n                } else {\r\n                    pedestal.node.children[0].active = false;\r\n                }\r\n            });\r\n            focseState = focseState ? 0 : 1;\r\n        }, 1000);\r\n        this.setp({\r\n            dice,\r\n            index,\r\n            flyIndex: -1,\r\n        }, typeof event !== 'number');\r\n    }\r\n\r\n\r\n    /**\r\n     * 移动棋子到指定位置\r\n     * @param chess    棋子\r\n     * @param point    坐标 [x, y, rotate?, duration?]\r\n     * @param duration 动画过度时间\r\n     */\r\n    moveChess(\r\n        chess: cc.Sprite,\r\n        point: number[] | false,\r\n        duration: number = .5,\r\n        move?: {\r\n            to: number;\r\n            from: number[];\r\n            index: number;\r\n            noJump?: boolean;\r\n        },\r\n        playerTarget?: number,\r\n    ) {\r\n        this.flyOver();\r\n        // console.log(move);\r\n        const playerIndex = playerTarget === undefined ? this.roomInfo.playerIndex : playerTarget;\r\n        const tNotePoint = notePoint[playerIndex];\r\n        let clock;\r\n        // 定位移动\r\n        if (move) {\r\n            let moveSpace = move.to - move.from[move.index];\r\n            // console.log('////////////////////////////////', this.roomInfo);\r\n            // console.log(moveSpace);\r\n            moveSpace = moveSpace > 1 ? moveSpace + 1 : moveSpace;\r\n            // console.log(moveSpace);\r\n            // console.log('move ', \r\n            //     '到: ' + move.to,\r\n            //     '格' + (move.to - move.from[move.index]),\r\n            //     move.from[move.index],\r\n            //     '棋子下标: ' + move.index\r\n            // );\r\n            let moveSetp = 1;\r\n            const { centerChessIndex } = this;\r\n            const targetCenterChess = centerChessIndex[playerIndex];\r\n            const moveTo = () => {\r\n                let moveIndex = move.from[move.index];\r\n                // 前往中央转折\r\n                if (moveIndex === tNotePoint.in) {\r\n                    if (!targetCenterChess[move.index]) {\r\n                        targetCenterChess[move.index] = 0;\r\n                        if (moveSpace > 2) moveSpace -= 1;\r\n                        // console.log(moveSpace);\r\n                    }\r\n                    if (moveSpace > 8) moveSpace -= 4; // 跳格修复\r\n                    // 超出底部进行回退\r\n                    // if (moveIndex >= tNotePoint.in + .5) moveSetp = -0.1;\r\n                    if (targetCenterChess[move.index] >= 5) moveSetp = -1;\r\n                    // 通过刚进来则改为小数点\r\n                    // if (moveSetp === 1) {\r\n                    //     moveSetp = 0.1;\r\n                    //     // playerIndex === 1 && moveSpace++;\r\n                    // };\r\n                    const moveI = targetCenterChess[move.index] += moveSetp;\r\n                    // console.log(moveIndex);\r\n                    // let moveI = (Math.ceil(((moveIndex * 100) / 10) - tNotePoint.in * 10)) - 1;\r\n                    // if (moveI === -1) moveI = 0;\r\n                    // console.log(\r\n                    //     '剩余：'  + moveSpace,\r\n                    //     '位置：'  + moveIndex,\r\n                    //     '绝对位:' + moveI,\r\n                    // );\r\n                    const centerPoint = centerPedestal[playerIndex][moveI];\r\n                    // 如果当前剩余2次（因为延迟-1）或投中1点 进入最后一个位置则判定完成\r\n                    if ((moveSpace === 1 || moveSpace === 2) && moveI === 5) {\r\n                        console.log('fly over');\r\n                        move.from[move.index] = -3;\r\n                        chess.spriteFrame = this.complete;\r\n                        this.moveChess(chess, this.chessSpawn[playerIndex][move.index]);\r\n                        clearInterval(clock);\r\n                        this.flyOver();\r\n                        // console.log(this.roomInfo.gameData);\r\n                        return true;\r\n                    }\r\n                    this.moveChess(chess, centerPoint);\r\n                    moveSpace--;\r\n                    if (moveSpace <= 1) clearInterval(clock);\r\n                    return;\r\n                }\r\n                move.from[move.index] += moveSetp;\r\n                moveSpace--;\r\n                \r\n                moveIndex = move.from[move.index];\r\n                // console.log(\r\n                //     '玩家:' + playerIndex,\r\n                //     '移动下标:' + moveIndex,\r\n                //     '移动个数:' + moveSpace,\r\n                //     '中:' + tNotePoint.in\r\n                // );\r\n                if (moveIndex > chessPoint.length - 1) {\r\n                    moveIndex = move.from[move.index] = 1;\r\n                }\r\n\r\n                // 飞行结束\r\n                if (moveSpace <= 1) {\r\n                    clearInterval(clock);\r\n                    // 起飞点检测\r\n                    if (moveIndex === tNotePoint.start) {\r\n                        // 跳到起飞点后再起飞\r\n                        setTimeout(() => {\r\n                            const flyData = chessPoint[tNotePoint.end];\r\n                            const i = playerIndex;\r\n                                flyData[2] = i === 0\r\n                                    ? 90 : i === 1\r\n                                        ? 180 : i === 2\r\n                                            ? -90 : 0\r\n                            ;\r\n                            this.moveChess(chess, flyData, 1.5);\r\n                            move.from[move.index] = tNotePoint.end;\r\n                            // 降落后跳四格\r\n                            setTimeout(() => {\r\n                                move.to = tNotePoint.end + 4;\r\n                                move.noJump = true;\r\n                                this.moveChess(chess, point, duration, move, playerIndex);\r\n                            }, 1500);\r\n                        }, 500);\r\n                    }\r\n\r\n                    // 如果操作的飞机为自己的飞机 则判为操作者 否则为数据同步\r\n                    // 检测是否覆盖到其他飞机上方\r\n                    // 如果覆盖则吃掉下方的飞机 并 同步数据\r\n                    // let existsChess = false;\r\n                    this.roomInfo.gameData.chess.forEach((chessArr, index) => {\r\n                        // console.log(playerTarget);\r\n                        if (index !== playerTarget) {\r\n                            chessArr.forEach((chessValue, chessIndex) => {\r\n                                // console.log(chessIndex, move.to);\r\n                                if (chessValue === move.to) {\r\n                                    // 覆盖中\r\n                                    // console.log(move.from, chessArr, chessIndex, move.to, playerTarget, this.roomInfo.playerIndex, move);\r\n                                    // move.from[chessIndex] = -2;\r\n                                    this.roomInfo.gameData.chess[index][chessIndex] = -2;\r\n                                    // console.log('覆盖');\r\n                                    // console.log(move.from, this.chessSpawn[index], index, chessIndex);\r\n                                    const backPoint = this.chessSpawn[index][chessIndex];\r\n                                    backPoint[2] = index === 0\r\n                                        ? 90 : index === 1\r\n                                            ? 180 : index === 2\r\n                                                ? -90 : 0\r\n                                    ;\r\n                                    this.moveChess(this.FlightPlayer[index].pedestal[chessIndex], backPoint);\r\n                                    // existsChess = true;\r\n                                    // console.log('玩家' + index + '被吃', chessArr, chessIndex, move.to);\r\n                                }\r\n                            })\r\n                        }\r\n                    });\r\n                    // console.log('----> ', move.from);\r\n                    // console.log('----|', this.roomInfo.gameData.chess);\r\n                    // if (existsChess) return true;\r\n                    // console.log('降落完毕');\r\n                    // console.log(move, this.roomInfo.gameData.chess);\r\n                }\r\n                this.moveChess(chess, chessPoint[moveIndex]);\r\n            }\r\n            // 判断是否跳跃\r\n            const endIndex = move.from[move.index] + moveSpace + (moveSpace > 1 ? -1 : 0);\r\n            if (\r\n                (endIndex) % 4 === playerIndex\r\n                && endIndex !== tNotePoint.start\r\n                && !move.noJump\r\n                && move.from[move.index] + moveSpace - 1 !== tNotePoint.in\r\n                && move.from[move.index] !== tNotePoint.in\r\n                && endIndex !== tNotePoint.in\r\n            ) {\r\n                const jumpSize = 4 + (moveSpace > 1 ? 0 : 1);\r\n                moveSpace += jumpSize;\r\n                move.to += jumpSize;\r\n            }\r\n            if (moveSpace !== 1) {\r\n                clock = setInterval(moveTo, 500);\r\n            }\r\n            return moveTo();\r\n        }\r\n\r\n        if (point) {\r\n            chess.node.runAction(\r\n                cc.moveTo(point[3] || duration, point[0], point[1]),\r\n            );\r\n            if (point[2] !== undefined) {\r\n                chess.node.runAction(\r\n                    cc.rotateTo(duration, point[2]),\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 暂停游戏\r\n     */\r\n    stopGames() {\r\n        cc.loader.loadRes('prefab/stopGames', cc.Prefab, (_err, prefab) => {\r\n            if (prefab) {\r\n                const popup = cc.instantiate(prefab);\r\n                cc.director.getScene().addChild(popup);\r\n                const stopGames = popup.getComponent('stopGames');\r\n                stopGames.backHomeEvent = () => {\r\n                    this.backHome();\r\n                };\r\n                // 设置分享\r\n                // stopGames.shareData = {\r\n                //     title: `一起来玩飞行棋吧!`,\r\n                //     imageUrl: State.OSS_BASE + '/H5Game/share/gobang.jpg',\r\n                //     query: !this.isMachine ? `fn=joinRoom&roomCode=${State.gameData.roomCode}` : '',\r\n                // }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 返回首页\r\n     */ \r\n    backHome() {\r\n        const { roomInfo, node, popupPrefab } = this;\r\n        // cc.director.loadScene('Home');\r\n        // return;\r\n        // console.log(State, playersData);\r\n        if (!roomInfo.players.length || roomInfo.players.length === 1) {\r\n            return this.gameOver(false);\r\n        }\r\n        const popup = cc.instantiate(popupPrefab);\r\n        const scriptPopup = popup.getComponent('popup');\r\n        cc.director.getScene().addChild(popup);\r\n        roomInfo.players.forEach((item, index: number) => {\r\n            if (item.id === State.userInfo.id) {\r\n                // console.log(index);\r\n                scriptPopup.init('是否要返回大厅?\\n' + (index ? '将退出房间' : '房间将被解散'));\r\n                scriptPopup.setEvent('success', () => {\r\n                    popup.destroy();\r\n                    // this.roomExit();\r\n                    cc.director.loadScene('Home');\r\n                });\r\n                scriptPopup.setEvent('close', () => {});\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 游戏结束\r\n     * @param data\r\n     *  - false: 房主离开游戏触发\r\n     */\r\n    gameOver(data: any | false) {\r\n        const { node, popupPrefab, FlightPlayer, roomInfo } = this;\r\n        // console.log(data);\r\n        if (data && data.type !== 0) {\r\n            this.gameOver = () => {};\r\n            const chessPrefab = cc.instantiate(this.chessPrefab);\r\n            const chessScript = chessPrefab.getComponent('overScript');\r\n            const chessData: any = [];\r\n            // console.log(data.gameData, data.gameData.score);\r\n            roomInfo.players.forEach((player, index) => {\r\n                // console.log(index);\r\n                chessData.push({\r\n                    nickname: player.nickname,\r\n                    avatarUrl: FlightPlayer[index].avatarUrl,\r\n                    score: 0,\r\n                    item: {\r\n                        // noteScore: gamedata.noteScore[index],\r\n                    },\r\n                });\r\n            });\r\n            chessScript.init({\r\n                players: chessData,\r\n                // itemKey: {\r\n                //     noteScore: '抓分',\r\n                // },\r\n                time: data.gameData.createTime,\r\n                roomId: data.roomCode,\r\n            });\r\n            this.node.addChild(chessPrefab);\r\n        } else if (roomInfo.playerIndex !== 0) {\r\n            const popup = cc.instantiate(popupPrefab);\r\n            const scriptPopup = popup.getComponent('popup');\r\n            cc.director.getScene().addChild(popup);\r\n            scriptPopup.init('房主已将房间解散!');\r\n            scriptPopup.setEvent('success', () => {\r\n                popup.destroy();\r\n                this.roomExit();\r\n                cc.director.loadScene('Home');\r\n            });\r\n        } else if (roomInfo.players.length === 1) {\r\n            this.roomExit();\r\n            cc.director.loadScene('Home');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 棋子走到终点时\r\n     */\r\n    flyOver() {\r\n        const { roomInfo } = this;\r\n        // 如果为房主则需要同步数据\r\n        if (roomInfo.playerIndex === 0) {\r\n            // 游戏结束检测\r\n            roomInfo.players.forEach((player, index) => {\r\n                console.log(roomInfo.gameData.chess[index].every((num => num !== -3)));\r\n                if (roomInfo.gameData.chess[index].every((num => num === -3))) {\r\n                    State.io.emit('flightChess/over', roomInfo.gameData.chess);\r\n                    return;\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n"]}