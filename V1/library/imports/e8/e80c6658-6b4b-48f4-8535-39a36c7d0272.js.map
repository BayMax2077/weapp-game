{"version":3,"sources":["assets\\scripts\\Games\\over\\overScript.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\nimport { dateFrom } from '../../../scripts/lib/tool';\r\nimport axios from '../../utils/axiosUtils';\r\n\r\nconst ItemData = cc.Class({\r\n    name: 'itemData',\r\n    properties: {\r\n        key: cc.Label,\r\n        value: cc.Label,\r\n    },\r\n})\r\n\r\nconst UserItem = cc.Class({\r\n    name: 'userItem',\r\n    properties: {\r\n        nickname: cc.Label,\r\n        avatarUrl: cc.Sprite,\r\n        score: cc.Label,\r\n        item: {\r\n            default: [],\r\n            type: ItemData,\r\n        },\r\n        winner: cc.Node,\r\n        Node: cc.Node,\r\n    },\r\n})\r\n\r\n@ccclass\r\nexport default class GameOver extends cc.Component {\r\n\r\n    @property(UserItem) UserItem: {\r\n        nickname: cc.Label;\r\n        avatarUrl: cc.Sprite;\r\n        score: cc.Label;\r\n        item: { key: cc.Label; value: cc.Label }[],\r\n        winner: cc.Node;\r\n        Node: cc.Node;\r\n    }[] = [];\r\n    // 房间ID\r\n    @property(cc.Label) roomId: cc.Label = null;\r\n    // 时间\r\n    @property(cc.Label) Time: cc.Label = null;\r\n    // 预览节点\r\n    @property(cc.Sprite) preview: cc.Sprite = null;\r\n    // 预览容器\r\n    @property(cc.Node) previewBox: cc.Node = null;\r\n    // 预览状态\r\n    privateState: boolean = false;\r\n    // 预览节点 图像\r\n    @property(cc.SpriteFrame) previewSprite: cc.SpriteFrame[] = [];\r\n\r\n    onLoad () {\r\n        this.UserItem.forEach(item => (item.Node.scale = 0));\r\n    }\r\n\r\n    /**\r\n     * 初始化\r\n     * @param players - 玩家\r\n     * @param time    - 结束时间\r\n     * @param roomId  - 房间号\r\n     */\r\n    init(initData: {\r\n        players: { \r\n            nickname: string;\r\n            avatarUrl: cc.SpriteFrame;\r\n            score: number;\r\n            item: { [key: string]: string },\r\n            winner: Boolean;\r\n        }[],\r\n        itemKey: string[],\r\n        time: number,\r\n        roomId: number,\r\n    }) {\r\n        const { UserItem } = this;\r\n        const { players } = initData;\r\n        players.forEach((item, index) => {\r\n            const userItem = UserItem[index];\r\n            setTimeout(() => {\r\n                userItem.Node.runAction(\r\n                    cc.scaleTo(1, 0.314, 0.456).easing(cc.easeBackOut()),\r\n                );\r\n            }, index * 100);\r\n            userItem.nickname.string = item.nickname;\r\n            console.log(item.score);\r\n            userItem.score.string = String(item.score);\r\n            userItem.avatarUrl.spriteFrame = item.avatarUrl;\r\n\r\n            // 得分项目\r\n            const params = item.item;\r\n            let i = 0;\r\n            for (const key in params) {\r\n                const keyName = initData.itemKey[key] || key;\r\n                const keyValue = params[key];\r\n                userItem.item[i].key.string = keyName;\r\n                userItem.item[i].value.string = keyValue;\r\n                i++;\r\n            }\r\n\r\n            // 赢家\r\n            if (item.winner) {\r\n                userItem.winner.opacity = 255;\r\n            }\r\n        });\r\n        this.roomId.string = '房间号：' + ( '000000' + initData.roomId).substr(-6);\r\n        this.Time.string = dateFrom('yyyy/MM/dd HH:mm:ss', initData.time);\r\n    }\r\n\r\n\r\n    /**\r\n     * 预览切换\r\n     */\r\n    previewToggle() {\r\n        const { privateState } = this;\r\n        this.previewBox.active = privateState;\r\n        this.preview.spriteFrame = this.previewSprite[privateState ? 0 : 1];\r\n        this.privateState = !privateState;\r\n    }\r\n\r\n\r\n    /**\r\n     * 返回大厅\r\n     */\r\n    backHome() {\r\n        cc.director.loadScene('Home');\r\n        axios.api('room_exit', {\r\n            data: {\r\n                roomCode: this.roomId.string,\r\n            },\r\n        }).then(() => {});\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}