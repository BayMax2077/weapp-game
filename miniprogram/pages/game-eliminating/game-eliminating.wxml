<!--pages/game-eliminating/game-eliminating.wxml-->
<view class="game-container">
  <!-- æ¸¸æˆå¤´éƒ¨ä¿¡æ¯ -->
  <view class="game-header">
    <view class="game-info">
      <view class="game-title">æ¶ˆæ¶ˆä¹</view>
      <view class="game-stats">
        <view class="stat-item">
          <view class="stat-label">åˆ†æ•°</view>
          <view class="stat-value">{{score}}</view>
        </view>
        <view class="stat-item">
          <view class="stat-label">æ­¥æ•°</view>
          <view class="stat-value">{{moves}}</view>
        </view>
        <view class="stat-item">
          <view class="stat-label">ç›®æ ‡</view>
          <view class="stat-value">{{target}}</view>
        </view>
      </view>
    </view>
    <view class="game-controls">
      <button class="btn btn-ghost btn-sm" bindtap="pauseGame">æš‚åœ</button>
      <button class="btn btn-ghost btn-sm" bindtap="restartGame">é‡å¼€</button>
    </view>
  </view>

  <!-- æ¸¸æˆæ£‹ç›˜ -->
  <view class="game-board">
    <view class="board-container" style="width: {{boardWidth}}px; height: {{boardHeight}}px;">
      <view 
        class="game-cell {{item.type}} {{item.selected ? 'selected' : ''}} {{item.eliminating ? 'eliminating' : ''}}" 
        wx:for="{{gameBoard}}" 
        wx:key="id"
        style="left: {{item.x}}px; top: {{item.y}}px; width: {{cellSize}}px; height: {{cellSize}}px;"
        bindtap="onCellTap"
        data-cell-id="{{item.id}}"
        data-row="{{item.row}}"
        data-col="{{item.col}}"
      >
        <view class="cell-content">
          <image class="cell-icon" src="{{item.icon}}" mode="aspectFit"></image>
        </view>
        <view class="cell-effect" wx:if="{{item.eliminating}}"></view>
      </view>
    </view>
  </view>

  <!-- æ¸¸æˆæç¤º -->
  <view class="game-hints" wx:if="{{showHint}}">
    <view class="hint-text">{{hintText}}</view>
  </view>

  <!-- ç‰¹æ®Šé“å…· -->
  <view class="game-tools" wx:if="{{showTools}}">
    <view class="tools-title">ç‰¹æ®Šé“å…·</view>
    <view class="tools-list">
      <button class="tool-item" bindtap="useTool" data-tool="bomb">
        <view class="tool-icon">ğŸ’£</view>
        <view class="tool-name">ç‚¸å¼¹</view>
        <view class="tool-count">{{tools.bomb}}</view>
      </button>
      <button class="tool-item" bindtap="useTool" data-tool="rainbow">
        <view class="tool-icon">ğŸŒˆ</view>
        <view class="tool-name">å½©è™¹</view>
        <view class="tool-count">{{tools.rainbow}}</view>
      </button>
      <button class="tool-item" bindtap="useTool" data-tool="hammer">
        <view class="tool-icon">ğŸ”¨</view>
        <view class="tool-name">é”¤å­</view>
        <view class="tool-count">{{tools.hammer}}</view>
      </button>
    </view>
  </view>

  <!-- æ¸¸æˆç»“æœå¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showResult}}" bindtap="hideResult">
    <view class="modal-content result-modal" catchtap="true">
      <view class="result-header">
        <view class="result-title">{{gameResult.title}}</view>
        <view class="result-subtitle">{{gameResult.subtitle}}</view>
      </view>
      <view class="result-content">
        <view class="result-stats">
          <view class="result-stat">
            <view class="stat-label">æœ€ç»ˆåˆ†æ•°</view>
            <view class="stat-value">{{gameResult.finalScore}}</view>
          </view>
          <view class="result-stat">
            <view class="stat-label">ä½¿ç”¨æ­¥æ•°</view>
            <view class="stat-value">{{gameResult.movesUsed}}</view>
          </view>
          <view class="result-stat">
            <view class="stat-label">æ¶ˆé™¤æ¬¡æ•°</view>
            <view class="stat-value">{{gameResult.eliminations}}</view>
          </view>
        </view>
        <view class="result-rewards" wx:if="{{gameResult.rewards.length > 0}}">
          <view class="rewards-title">è·å¾—å¥–åŠ±</view>
          <view class="rewards-list">
            <view class="reward-item" wx:for="{{gameResult.rewards}}" wx:key="type">
              <view class="reward-icon">{{item.icon}}</view>
              <view class="reward-name">{{item.name}}</view>
              <view class="reward-count">+{{item.count}}</view>
            </view>
          </view>
        </view>
      </view>
      <view class="result-actions">
        <button class="btn btn-outline" bindtap="restartGame">å†æ¥ä¸€å±€</button>
        <button class="btn btn-primary" bindtap="backToHome">è¿”å›é¦–é¡µ</button>
      </view>
    </view>
  </view>

  <!-- æš‚åœå¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showPause}}" bindtap="hidePause">
    <view class="modal-content pause-modal" catchtap="true">
      <view class="pause-header">
        <view class="pause-title">æ¸¸æˆæš‚åœ</view>
      </view>
      <view class="pause-actions">
        <button class="btn btn-primary btn-full" bindtap="resumeGame">ç»§ç»­æ¸¸æˆ</button>
        <button class="btn btn-outline btn-full" bindtap="restartGame">é‡æ–°å¼€å§‹</button>
        <button class="btn btn-ghost btn-full" bindtap="backToHome">è¿”å›é¦–é¡µ</button>
      </view>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-overlay" wx:if="{{loading}}">
  <view class="loading-content">
    <view class="loading"></view>
    <view class="loading-text">æ¸¸æˆåŠ è½½ä¸­...</view>
  </view>
</view>
