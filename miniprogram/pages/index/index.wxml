<!--pages/index/index.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="card user-info-card" wx:if="{{userInfo}}">
    <view class="flex items-center">
      <image class="avatar avatar-lg" src="{{userInfo.avatarUrl || '/assets/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="flex-1 ml-3">
        <view class="text-lg font-semibold">{{userInfo.nickname || 'æ¸¸å®¢ç”¨æˆ·'}}</view>
        <view class="text-sm text-secondary">æ¬¢è¿å›æ¥ï¼</view>
      </view>
      <view class="flex items-center">
        <view class="badge badge-primary" wx:if="{{userAssets}}">{{userAssets.coins || 0}}</view>
        <view class="badge badge-success ml-2" wx:if="{{userAssets}}">{{userAssets.diamonds || 0}}</view>
      </view>
    </view>
  </view>

  <!-- æ¸¸æˆåˆ—è¡¨ -->
  <view class="card">
    <view class="card-header">
      <view class="card-title">çƒ­é—¨æ¸¸æˆ</view>
      <view class="card-subtitle">é€‰æ‹©ä½ å–œæ¬¢çš„æ¸¸æˆå¼€å§‹å§</view>
    </view>
    
    <view class="grid grid-cols-2" wx:if="{{gameList.length > 0}}">
      <view class="game-card" wx:for="{{gameList}}" wx:key="id" bindtap="onGameSelect" data-game-id="{{item.id}}">
        <view class="game-card-content">
          <image class="game-icon" src="{{item.icon || '/assets/images/game-default.png'}}" mode="aspectFill"></image>
          <view class="game-info">
            <view class="game-name">{{item.name}}</view>
            <view class="game-desc">{{item.description}}</view>
            <view class="game-stats">
              <view class="label label-primary">{{item.players || 0}}äººåœ¨ç©</view>
            </view>
          </view>
        </view>
        <view class="game-actions">
          <button class="btn btn-primary btn-sm" bindtap="quickStart" data-game-id="{{item.id}}" catchtap="true">å¿«é€Ÿå¼€å§‹</button>
          <button class="btn btn-outline btn-sm" bindtap="createRoom" data-game-id="{{item.id}}" catchtap="true">åˆ›å»ºæˆ¿é—´</button>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:else>
      <image class="empty-icon" src="/assets/images/empty-games.png" mode="aspectFit"></image>
      <view class="empty-text">æš‚æ— æ¸¸æˆ</view>
      <view class="empty-desc">è¯·ç¨åå†è¯•</view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="card">
    <view class="card-header">
      <view class="card-title">å¿«é€Ÿæ“ä½œ</view>
    </view>
    
    <view class="grid grid-cols-2">
      <button class="btn btn-ghost quick-action-btn" bindtap="onRandomGame">
        <view class="quick-action-icon">ğŸ²</view>
        <view class="quick-action-text">éšæœºæ¸¸æˆ</view>
      </button>
      <button class="btn btn-ghost quick-action-btn" bindtap="onJoinRoom">
        <view class="quick-action-icon">ğŸ </view>
        <view class="quick-action-text">åŠ å…¥æˆ¿é—´</view>
      </button>
    </view>
  </view>

  <!-- æœ€è¿‘æ¸¸æˆ -->
  <view class="card" wx:if="{{recentGames.length > 0}}">
    <view class="card-header">
      <view class="card-title">æœ€è¿‘æ¸¸æˆ</view>
    </view>
    
    <view class="list">
      <view class="list-item" wx:for="{{recentGames}}" wx:key="id" bindtap="onRecentGame" data-game-id="{{item.id}}">
        <image class="avatar" src="{{item.icon}}" mode="aspectFill"></image>
        <view class="list-item-content">
          <view class="list-item-title">{{item.name}}</view>
          <view class="list-item-subtitle">ä¸Šæ¬¡æ¸¸æˆï¼š{{item.lastPlayTime}}</view>
        </view>
        <view class="list-item-action">></view>
      </view>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-overlay" wx:if="{{loading}}">
  <view class="loading-content">
    <view class="loading"></view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
</view>